\documentclass[oneside,a4paper]{ctexbook}

\usepackage{amsmath,amsthm,amssymb,mathrsfs,mathtools}
\usepackage{geometry}
\usepackage{enumerate}
\usepackage{enumitem}

\newlist{enumerate_bf_alph}{enumerate}{1}
\setlist[enumerate_bf_alph]{label=\textbf{\alph*.}}

\newlist{enumerate_bf_arabic}{enumerate}{1}
\setlist[enumerate_bf_arabic]{label=\textbf{\arabic*}}

\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{tkz-euclide}
\usetikzlibrary{shapes.callouts,arrows.meta,calc,shadings}

\usepackage{hyperref}

\newcounter{problem}
\newenvironment{problem}[1][]{
    \refstepcounter{problem}
    \noindent\textbf{\theproblem.\hspace{1em}#1}
    % \par\bigskip
}{}

\newenvironment{problem*}[1][]{
    \par\bigskip
    \noindent\textbf{#1}
}{}

\newenvironment{solution}{\begin{proof}[\textbf{\emph{解.}}]}{\end{proof}}

\begin{document}

\section*{Problem Set 2}

\begin{problem}[Nash Equilibria and Iterative Deletion]
    考虑以下博弈。

    \begin{table}[h!]
        \centering
        \begin{tabular}{c|ccc}
            & L & C & R \\
            \hline
            T & (2, 0) & (1, 1) & (4, 2) \\
            M & (3, 4) & (1, 2) & (2, 3) \\
            B & (1, 3) & (0, 2) & (3, 0) \\
        \end{tabular}
        \caption{Nash Equilibria and Iterative Deletion}
    \end{table}

    \begin{enumerate_bf_alph}
        \item 哪些策略在迭代剔除严格劣势策略后仍然保留？
        \item 找出此博弈的（纯策略）纳什均衡。
        \item 请尽可能简洁但严谨地论证，一般而言（不仅仅是此博弈中），纳什均衡中的策略永远不会在迭代剔除严格劣势策略的过程中被剔除。
    \end{enumerate_bf_alph}
\end{problem}

\begin{solution}
    \begin{enumerate_bf_alph}
        \item T，M，L 和 R。
        \item (M,L) 和 (T,R)。
        \item 设有一个包含 $n$ 个参与者的博弈，第 $i$ 个参与者的策略集合为 $S_i$ 其收益函数为
        \[
        u_i : S_1 \times S_2 \times \cdots \times S_n \to \mathbb{R} \,,
        \]
        策略组合
        \[
        s^\ast \coloneqq (s_1^\ast, s_2^\ast, \dots, s_n^\ast)
        \]
        是该博弈的纳什均衡。由于 $s^\ast$ 是该博弈的纳什均衡，因此对于任意参与者 $i$ 都有
        \[
        u_i(s_i^\ast, s_{-i}^\ast) \geq u_i(s_i, s_{-i}^\ast) \,,\quad \forall s_i \in S_i \,,
        \]
        于是可知 $s_i^\ast$ 不会严格劣势于参与者 $i$ 的其余策略，即 $s_i^\ast$ 不会在第 $1$ 轮剔除中被剔除。假设 $s^\ast$ 的各分量在第 $k$ 轮剔除中不会被剔除, 现证明 $s^\ast$ 的各分量在第 $k+1$ 轮剔除中不会被剔除。假设 $s_i^\ast$ 在第 $k+1$ 轮剔除中被剔除，即存在策略 $t_i \in S_i^k$ 使得
        \[
        u_i(s_i^\ast, s_{-i}) < u_i(t_i, s_{-i}) \,,\quad \forall s_{-i} \in S_{-i}^k \,,
        \]
        其中 $S_i^k$ 是第 $k$ 轮剔除后参与者 $i$ 的策略集合。只用令 $s_{-i} = s_{-i}^\ast$，于是
        \[
        u_i(s_i^\ast, s_{-i}^\ast) < u_i(t_i, s_{-i}^\ast) \,,
        \]
        这与 $s^\ast$ 作为纳什均衡矛盾，故 $s_i^\ast$ 不会被剔除。因此由数学归纳法可知，$s^\ast$ 的各分量在迭代剔除严格劣势策略中不会被剔除。
    \end{enumerate_bf_alph}
\end{solution}

\newpage

\begin{problem}[Splitting the Dollar(s)]
    玩家 1 和玩家 2 正在就如何分配 \$10 进行讨价还价。每个玩家 $i$ 为自己报出一个金额 $s_i$，取值范围在 $0$ 到 $10$ 之间。这些数值不要求是整数。两位玩家同时作出选择。每个玩家的收益等于她自己实际得到的钱数。我们将考虑该博弈在两种不同规则下的情况。在这两种规则中，如果 $s_1 + s_2 \leq 10 $，则两位玩家各自得到自己所报的金额（若有剩余金额，则被销毁）。

    \begin{enumerate_bf_alph}
        \item 第一种规则，如果 $s_1 + s_2 > 10$，则两位玩家都得到 \$0，剩余的钱被销毁。这个博弈的（纯策略）纳什均衡是什么？
        \item 第二种规则，如果 $s_1 + s_2 > 10$ 且两人报出的金额不同，则报出较小金额的人获得自己报的金额，而另一位获得剩余的金额。如果 $s_1 + s_2 > 10$ 且 $s_1 = s_2$，则两位玩家各得 \$5。这个博弈的（纯策略）纳什均衡是什么？
        \item 现在假设这两个博弈都增加一条额外规则，即玩家报出的金额必须是整数美元。这个改变会不会影响任意一种情形中的（纯策略）纳什均衡？
    \end{enumerate_bf_alph}
\end{problem}

\begin{solution}
    \begin{enumerate_bf_alph}
        \item $s \in \{(x, 10 - x) \mid x \in [0, 10]\}$ 都是纳什均衡。
        \item $(5,5)$。
        \item 第一种规则下纳什均衡变为 $s \in \{(x, 10 - x) \mid x = 0, 1, 2, \dots, 10\}$，第二种规则下纳什均衡将变为 $(5,5), (5,6), (6,5), (6,6)$。
    \end{enumerate_bf_alph}
\end{solution}

\newpage

\section*{Problem Set 3}

\begin{problem}[The Linear City: Price Competition with Differentiated Products]
    在课堂上，我们讨论了两种双寡头竞争模型：Cournot（产量）竞争和 Bertrand（价格）竞争。看起来把企业视为以价格而非产量竞争更为现实，但 Cournot 的结果又比 Bertrand 的结果更 ``符合直觉''。本题考虑第三种双寡头竞争模型。像 Bertrand 那样，两家公司将以价格而不是产量进行竞争。但与 Bertrand 模型不同的是，两家公司的产品并非同质。用经济学术语说，产品是差异化的。我不会在黑板上为你们推导该模型，而是让你们自己来解。不过别慌：习题组会一步步引导你。

    \begin{itemize}
        \item 我们把一座 ``城市'' 看作一条长度为 $1$ 的线段。
        \item 有两家企业，1 和 2，分别位于这条线段的两端。
        \begin{itemize}
            \item 两家企业同时选择价格，分别为 $p_1$ 和 $p_2$。
            \item 两家企业的边际成本都相同，记为 $c$。
            \item 每个企业的目标都是最大化自己的利润。
        \end{itemize}
        \item 潜在消费者均匀分布在线段上，每个点上有一个消费者。
        \begin{itemize}
            \item 设总消费者数量为 $1$（或者如果你愿意，也可以理解为市场份额）。
        \end{itemize}
        \item 每个潜在消费者都只买 $1$ 单位的产品，购买对象只能是企业 1 或企业 2。因此，总需求始终正好为 $1$。
        \item 考虑位于线段上位置为 $y$ 的消费者。他距离企业 1 的距离是 $y$，距离企业 2 的距离是 $1−y$。
        \begin{itemize}
            \item 位于位置 $y$ 的消费者会选择购买企业 1 的产品，如果
            \begin{align}\label{Pset_3_TLC_E1}
            p_1 + t y^2 < p_2 + t (1 - y)^2 \,;
            \end{align}
            会选择购买企业 2 的产品，如果
            \begin{align}\label{Pset_3_TLC_E2}
            p_1 + t y^2 > p_2 + t (1 - y)^2 \,;
            \end{align}
            如果两边刚好相等，那么他将公平地抛硬币决定购买哪一家。
        \end{itemize}
    \end{itemize}

    消费者同时在乎价格和与企业之间的 ``距离''。如果我们把这条线理解为地理距离，那么 $t \times \text{距离}^2$ 这一项就可以理解为消费者去到该企业的 ``交通成本''。或者，如果我们把这条线理解为产品质量的一种维度——比如冰淇淋的脂肪含量——那么这项就是消费者为了购买自己最理想的产品而付出的 ``不便利成本''。当交通成本参数 $t$ 越大时，我们可以认为在消费者眼中两家企业的产品越具有差异化。如果 $t=0$，那么两种产品就是完全替代品。

    \begin{enumerate_bf_alph}
        \item\label{Pset_3_TLC_Q1} 企业 $i$ 会不会设定其价格 $p_i < c$？为什么？
        \item\label{Pset_3_TLC_Q2} 假设企业 2 设置了价格 $p_2$。在什么价格下企业 1 能够拿下整个市场（也就是说，给定 $p_2$，设定什么 $p_1$ 会让所有消费者都从企业 1 购买）？
    \end{enumerate_bf_alph}

    让我们来考虑一下，企业 1 是否可以通过将价格设定得比 \ref{Pset_3_TLC_Q2} 的答案更高而获得更高利润。企业 1 提高价格的坏处在于它会失去一部分市场份额。好处在于对于仍然留下来的顾客，它可以收取更高的价格。接下来的问题将帮助你计算当两家企业的价格 ``很接近'' 时，会有多少顾客选择从企业 1 购买。

    \begin{enumerate_bf_alph}[start=3]
        \item 假设价格 $p_1$ 和 $p_2$ 足够接近，使得市场被两家企业分割（不一定是均分）。利用 \eqref{Pset_3_TLC_E1} 和 \eqref{Pset_3_TLC_E2} 找出那个对从企业 1 购买和从企业 2 购买完全无差异的消费者的位置。利用你的答案来说明，当市场被分割时，企业 1 的需求由下式给出：
        \begin{align}\label{Pset_3_TLC_E3}
            D_1(p_1, p_2) = \frac{p_2 + t - p_1}{2t} \,.
        \end{align}
    \end{enumerate_bf_alph}

    现在我们已经拥有所有需要的信息来计算在每个给定的 $p_2$ 下，企业 1 的最佳对策。当市场被分割时，企业 1 的利润由下式给出：
    \begin{align}\label{Pset_3_TLC_E4}
        u_1(p_1, p_2) = p_1 D_1(p_1, p_2) - c D_1(p_1, p_2) \,,
    \end{align}
    其中第一项是收入，第二项是成本。

    \begin{enumerate_bf_alph}[start=4]
        \item 利用 \eqref{Pset_3_TLC_E3} 和 \eqref{Pset_3_TLC_E4}，再结合一些简单的微积分，证明对于中间水平的 $p_2$，有
        \begin{align}
            BR_1(p_2) = \frac{p_2 + t + c}{2} \,.
        \end{align}
        \item\label{Pset_3_TLC_Q5} 画出企业 1 和企业 2 的最佳对策曲线。在图中标明当 $p_2 < c - t$ 和 $p_2 > 3t + c$ 时 $BR_1(p_2)$ 会怎样。（提示：回忆你对 \ref{Pset_3_TLC_Q1} 和 \ref{Pset_3_TLC_Q2} 的回答。）
        \item 使用代数方法求出纳什均衡。
        \item 当 $t = 0$ 时，均衡价格是多少？请解释你的答案。人们有时会说：``随着产品变得不那么相似和更具差异化，竞争会变得不那么激烈。'' 在我们的模型中，这句话是如何体现出来的？
    \end{enumerate_bf_alph}
\end{problem}

\begin{solution}
    \begin{enumerate_bf_alph}
        \item 不会。
        \item 要确定什么 $p_1$ 会让所有消费者都从企业 1 购买，只用让 $y = 1$ 处的消费者从企业 1 购买。令 $y = 1$ 代入 \eqref{Pset_3_TLC_E1} 可知
        \[
        p_1 < p_2 - t
        \]
        时，$y = 1$ 处的消费者会从企业 1 购买。
        \item 由 \eqref{Pset_3_TLC_E1} 和 \eqref{Pset_3_TLC_E2} 可知，当
        \[
        p_1 + t y^2 = p_2 + t (1 - y)^2
        \]
        时，$y$ 处的消费者从企业 1 购买和从企业 2 购买完全无差异，解得其位置
        \[
        y = \frac{p_2 + t - p_1}{2t} \,.
        \]
        同时，任意
        \[
        y < \frac{p_2 + t - p_1}{2t}
        \]
        的消费者都会选择购买企业 1 的产品。因此，可以得出企业 1 的需求
        \[
        D_1(p_1, p_2) = \frac{p_2 + t - p_1}{2t} \,.
        \]
        \item 将 \eqref{Pset_3_TLC_E3} 代入 \eqref{Pset_3_TLC_E4} 整理可得
        \[
        u_1(p_1, p_2) = \frac{p_1 p_2 + t p_1 - p_1^2 - c p_2 - ct + c p_1}{2t} \,.
        \]
        要找到给定 $p_2$ 时，企业 1 的最佳对策，即找到 $u_1$ 的最大值点。令
        \[
        \frac{\partial u_1}{\partial p_1} = \frac{p_2 + t - 2p_1 + c}{2t} = 0 \,,
        \]
        解得
        \[
        p_1 = \frac{p_2 + t + c}{2} \,.
        \]
        此时
        \[
        \frac{\partial^2 u_1}{\partial p_1^2} = -\frac{1}{t} < 0 \,,
        \]
        故给定 $p_2$ 时，$p_1 = (p_2 + t + c)/2$ 是 $u_1$ 的最大值点，即
        \[
        BR_1(p_2) = \frac{p_2 + t + c}{2} \,.
        \]
        \item 当 $p_2 < c - t$ 时，我们假设
        \[
        p_2 = c - t - \varepsilon \,,
        \]
        其中 $\varepsilon$ 为一个足够小的正数，将 $p_2$ 代入 $BR_1$ 可得此时企业 1 的最佳对策
        \[
        p_1^\ast = c - \frac{\varepsilon}{2} \,,
        \]
        将该 $p_1^\ast, p_2$ 代入 \eqref{Pset_3_TLC_E2} 整理可得
        \[
        y > -\frac{\varepsilon}{4t} \,,
        \]
        故企业 2 将拿下整个市场。当 $p_2 > 3t + c$ 时，我们假设
        \[
        p_2 = 3t + c + \varepsilon \,,
        \]
        其中 $\varepsilon$ 为一个足够小的正数，将 $p_2$ 代入 $BR_1$ 可得此时企业 1 的最佳对策
        \[
        p_1^\ast = 2t + c + \frac{\varepsilon}{2} \,,
        \]
        将该 $p_1^\ast, p_2$ 代入 \eqref{Pset_3_TLC_E1} 整理可得
        \[
        y < 1 + \frac{\varepsilon}{4t} \,,
        \]
        故企业 1 将拿下整个市场。
        \begin{center}
            \begin{tikzpicture}
                % \draw[dashed] (0,0) grid (5,5);
                \draw[->] (0,0) -- (5,0) node[right]{$p_1$};
                \node[left] at (0,0){$O$};
                \draw[->] (0,0) -- (0,5) node[above]{$p_2$};

                % \node[below] at (1,0){$\frac{t+c}{2}$};
                % \node[below] at (2,0){$\frac{2(t+c)}{2}$};
                % \node[below] at (3,0){$\frac{3(t+c)}{2}$};
                % \node[below] at (4,0){$\frac{4(t+c)}{2}$};
                % \node[left] at (0,1){$\frac{t+c}{2}$};
                % \node[left] at (0,2){$\frac{2(t+c)}{2}$};
                % \node[left] at (0,3){$\frac{3(t+c)}{2}$};
                % \node[left] at (0,4){$\frac{4(t+c)}{2}$};

                \draw (1,0) -- (3,4) node[right]{$BR_1$};
                \draw (0,1) -- (4,3) node[right]{$BR_2$};
            \end{tikzpicture}
        \end{center}
        \item 设纳什均衡为 $(p_1^\ast, p_2^\ast)$。由 \ref{Pset_3_TLC_Q5} 可知，$BR_1$ 和 $BR_2$ 的交点即为纳什均衡，令 $p_1^\ast = p_2^\ast = p^\ast$ 代入 $BR_1$ 可解得
        \[
        p^\ast = c + t \,.
        \]
        \item $p_1 = p_2 = c$。当消费者付出的交通成本高于产品价差时，消费者将选择 ``高价'' 产品。
    \end{enumerate_bf_alph}
\end{solution}

\newpage

\end{document}